<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="本文译自 A Tour of Versioned Go (vgo), Go &amp;amp; Versioning 的第 2 部分, 版权@归原文所有.">
<meta name="keywords" content="translation,go,vgo">
<meta property="og:type" content="article">
<meta property="og:title" content="版本化 Go 之旅">
<meta property="og:url" content="https://lingchao.xin/post/vgo-tour.html">
<meta property="og:site_name" content="Coding talks">
<meta property="og:description" content="本文译自 A Tour of Versioned Go (vgo), Go &amp;amp; Versioning 的第 2 部分, 版权@归原文所有.">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2018-04-15T08:54:02.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="版本化 Go 之旅">
<meta name="twitter:description" content="本文译自 A Tour of Versioned Go (vgo), Go &amp;amp; Versioning 的第 2 部分, 版权@归原文所有.">
    
    
        
          
              <link rel="shortcut icon" href="https://www.gravatar.com/avatar/f4254a13e728ba649241e5776b4884db?s=16">
          
        
        
          
            <link rel="icon" type="image/png" href="https://www.gravatar.com/avatar/f4254a13e728ba649241e5776b4884db?s=192" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="https://www.gravatar.com/avatar/f4254a13e728ba649241e5776b4884db?s=180">
          
        
    
    <!-- title -->
    <title>版本化 Go 之旅</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss -->
    
    
      <link rel="alternate" href="/atom.xml" title="Coding talks" type="application/atom+xml" />
    
</head>

<body class="max-width mx-auto px3">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Archives</a></li>
         
          <li><a href="/atom.xml">Feed</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/post/vgo-import.html"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/post/vgo-intro.html"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://lingchao.xin/post/vgo-tour.html"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://lingchao.xin/post/vgo-tour.html&text=版本化 Go 之旅"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://lingchao.xin/post/vgo-tour.html&title=版本化 Go 之旅"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://lingchao.xin/post/vgo-tour.html&is_video=false&description=版本化 Go 之旅"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=版本化 Go 之旅&body=Check out this article: https://lingchao.xin/post/vgo-tour.html"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://lingchao.xin/post/vgo-tour.html&title=版本化 Go 之旅"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://lingchao.xin/post/vgo-tour.html&title=版本化 Go 之旅"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://lingchao.xin/post/vgo-tour.html&title=版本化 Go 之旅"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://lingchao.xin/post/vgo-tour.html&title=版本化 Go 之旅"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://lingchao.xin/post/vgo-tour.html&name=版本化 Go 之旅&description=&lt;p&gt;本文译自 &lt;a href=&#34;https://research.swtch.com/vgo-tour&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;A Tour of Versioned Go (vgo)&lt;/a&gt;, &lt;a href=&#34;https://lingchao.xin/tag/vgo.html&#34;&gt;Go &amp;amp; Versioning&lt;/a&gt; 的第 2 部分, 版权@归原文所有.&lt;br&gt;"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#示例"><span class="toc-number">1.</span> <span class="toc-text">示例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Hello-world"><span class="toc-number">1.1.</span> <span class="toc-text">Hello, world</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#升级"><span class="toc-number">1.2.</span> <span class="toc-text">升级</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#降级"><span class="toc-number">1.3.</span> <span class="toc-text">降级</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#排除-Excluding"><span class="toc-number">1.4.</span> <span class="toc-text">排除 (Excluding)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#替换-Replacing"><span class="toc-number">1.5.</span> <span class="toc-text">替换 (Replacing)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#向后兼容性"><span class="toc-number">1.6.</span> <span class="toc-text">向后兼容性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#接下来"><span class="toc-number">2.</span> <span class="toc-text">接下来 ?</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        版本化 Go 之旅
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Coding talks</span>
      </span>
      
    <div class="postdate">
        <time datetime="2018-02-22T03:01:04.000Z" itemprop="datePublished">2018-02-22</time>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/go/">go</a>, <a class="tag-link" href="/tags/translation/">translation</a>, <a class="tag-link" href="/tags/vgo/">vgo</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>本文译自 <a href="https://research.swtch.com/vgo-tour" target="_blank" rel="noopener">A Tour of Versioned Go (vgo)</a>, <a href="https://lingchao.xin/tag/vgo.html">Go &amp; Versioning</a> 的第 2 部分, 版权@归原文所有.<br><a id="more"></a></p>
<p>对我而言, 设计意味着构建, 拆除和再次构建, 一遍又一遍. 为了编写<a href="https://research.swtch.com/vgo-intro" target="_blank" rel="noopener">新的版本控制提案</a>, 我构建了一个原型 vgo, 来处理许多细微的细节. 这篇博文展示了如何使用 vgo.</p>
<p>你现在可以通过运行 go get golang.org/x/vgo 下载并尝试 vgo. Vgo 是 go 命令的一个直接替换(和分支拷贝). 你运行 vgo 而不是 go, 它将使用你安装在 $GOROOT (Go 1.10 beta1 或更高版本) 的编译器和标准库.</p>
<p>随着我们更多地了解什么可行, 什么不可行, vgo 的语义和命令行细节可能会发生变化. 但是, 我们打算避免 go.mod 文件格式的向后不兼容的更改, 以便今天添加了 go.mod 的项目以后也可以工作. 在我们完善提案时, 我们也会相应地更新 vgo.</p>
<h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><p>该部分演示怎么使用 vgo. 请按照步骤进行实验.</p>
<p>从安装 vgo 开始:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ go get -u golang.org/x/vgo</span><br></pre></td></tr></table></figure>
<p>你一定会遇到有趣的 bug, 因为 vgo 现在最多只有轻微的测试. 请使用 <a href="https://golang.org/issue" target="_blank" rel="noopener">Go 问题跟踪</a> 进行 bug 上报, 标题以 “x/vgo” 开头. 多谢.</p>
<h3 id="Hello-world"><a href="#Hello-world" class="headerlink" title="Hello, world"></a>Hello, world</h3><p>我们来写一个有趣的 “Hello, world” 程序. 在 GOPATH/src 目录之外创建一个目录并切换到它:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ cd $HOME</span><br><span class="line">$ mkdir hello</span><br><span class="line">$ cd hello</span><br></pre></td></tr></table></figure>
<p>然后创建一个 hello.go:</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main <span class="comment">// import "github.com/you/hello"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"rsc.io/quote"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(quote.Hello())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>或者下载它:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ curl -sS https://swtch.com/hello.go &gt;hello.go</span><br></pre></td></tr></table></figure>
<p>创建一个空的 go.mod 文件来标记此模块的根目录, 然后构建并运行新程序:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ echo &gt;go.mod</span><br><span class="line">$ vgo build</span><br><span class="line">vgo: resolving import &quot;rsc.io/quote&quot;</span><br><span class="line">vgo: finding rsc.io/quote (latest)</span><br><span class="line">vgo: adding rsc.io/quote v1.5.2</span><br><span class="line">vgo: finding rsc.io/quote v1.5.2</span><br><span class="line">vgo: finding rsc.io/sampler v1.3.0</span><br><span class="line">vgo: finding golang.org/x/text v0.0.0-20170915032832-14c0d48ead0c</span><br><span class="line">vgo: downloading rsc.io/quote v1.5.2</span><br><span class="line">vgo: downloading rsc.io/sampler v1.3.0</span><br><span class="line">vgo: downloading golang.org/x/text v0.0.0-20170915032832-14c0d48ead0c</span><br><span class="line">$ ./hello</span><br><span class="line">Hello, world.</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>注意这里没有显式的需要运行 vgo get. 普通的 vgo build 将在遇到未知导入时查找包含它的模块, 并将该模块的最新版本作为依赖添加到当前模块中.</p>
<p>运行任何 vgo 命令的一个副作用是必要时会更新 go.mod. 这种情况下, vgo build 会写入新的 go.mod 文件:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ cat go.mod</span><br><span class="line">module &quot;github.com/you/hello&quot;</span><br><span class="line"></span><br><span class="line">require &quot;rsc.io/quote&quot; v1.5.2</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>由于 go.mod 已写入, 下一次 vgo build 将不会再次解析导入或打印那么多:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ vgo build</span><br><span class="line">$ ./hello</span><br><span class="line">Hello, world.</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>即使明天发布了 rsc.io/quote v1.5.3 或 v1.6.0, 该目录中的构建仍将继续使用 v1.5.2, 除非进行明确的升级(见下文).</p>
<p>go.mod 文件列举了依赖的最小集合, 忽略了已列举中所隐含的. 在这种情况下, rsc.io/quote v1.5.2 依赖特定版本的 rsc.io/sampler 和 golang.org/x/text, 所以在 go.mod 中重复列举它们是冗余的.</p>
<p>使用 vgo list -m 仍然可以找到构建所需的全套模块:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ vgo list -m</span><br><span class="line">MODULE                VERSION</span><br><span class="line">github.com/you/hello  -</span><br><span class="line">golang.org/x/text     v0.0.0-20170915032832-14c0d48ead0c</span><br><span class="line">rsc.io/quote          v1.5.2</span><br><span class="line">rsc.io/sampler        v1.3.0</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>此时你可能想知道为什么我们简单的 “hello world” 程序会使用 golang.org/x/text. 实际上 rsc.io/quote 依赖 rsc.io/sampler, 后者又依赖 golang.org/x/text 进行 <a href="https://blog.golang.org/matchlang" target="_blank" rel="noopener">language matching</a> .</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ LANG=fr ./hello</span><br><span class="line">Bonjour le monde.</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h3 id="升级"><a href="#升级" class="headerlink" title="升级"></a>升级</h3><p>我们已经看到, 当必须将新模块添加到构建以解决新的导入时, vgo 会采用最新的模块. 此前, 它需要 rsc.io/quote, 并发现 v1.5.2 是最新的. 但除了解析新的导入, vgo 仅使用 go.mod 文件中列出的版本. 在我们的例子中, rsc.io/quote 间接依赖于 golang.org/x/text 和 rsc.io/sampler 的特定版本. 事实证明, 这两个软件包都有较新的版本, 正如我们通过 vgo list -u (检查更新的软件包)看到的那样:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ vgo list -m -u</span><br><span class="line">MODULE                VERSION                             LATEST</span><br><span class="line">github.com/you/hello  -                                   -</span><br><span class="line">golang.org/x/text     v0.0.0-20170915032832-14c0d48ead0c  v0.0.0-20180208041248-4e4a3210bb54</span><br><span class="line">rsc.io/quote          v1.5.2 (2018-02-14 10:44)           -</span><br><span class="line">rsc.io/sampler        v1.3.0 (2018-02-13 14:05)           v1.99.99 (2018-02-13 17:20)</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>这两个软件包都有更新的版本, 所以我们可能想在我们的 hello 程序中升级它们.</p>
<p>首先升级 golang.org/x/text:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ vgo get golang.org/x/text</span><br><span class="line">vgo: finding golang.org/x/text v0.0.0-20180208041248-4e4a3210bb54</span><br><span class="line">vgo: downloading golang.org/x/text v0.0.0-20180208041248-4e4a3210bb54</span><br><span class="line">$ cat go.mod</span><br><span class="line">module &quot;github.com/you/hello&quot;</span><br><span class="line"></span><br><span class="line">require (</span><br><span class="line">	&quot;golang.org/x/text&quot; v0.0.0-20180208041248-4e4a3210bb54</span><br><span class="line">	&quot;rsc.io/quote&quot; v1.5.2</span><br><span class="line">)</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>vgo get 命令将查找给定模块的最新版本, 并通过更新 go.mod 来将该版本添加为当前模块的依赖. 从现在开始, 未来的构建将使用较新的 text 模块:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ vgo list -m</span><br><span class="line">MODULE                VERSION</span><br><span class="line">github.com/you/hello  -</span><br><span class="line">golang.org/x/text     v0.0.0-20180208041248-4e4a3210bb54</span><br><span class="line">rsc.io/quote          v1.5.2</span><br><span class="line">rsc.io/sampler        v1.3.0</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>当然, 升级之后, 测试一切仍然工作良好是个好主意. 我们的依赖 rsc.io/quote 和 rsc.io/sampler 尚未使用较新的 text 模块进行测试. 我们可以在我们创建的配置中运行他们的测试:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ vgo test all</span><br><span class="line">?   	github.com/you/hello	[no test files]</span><br><span class="line">?   	golang.org/x/text/internal/gen	[no test files]</span><br><span class="line">ok  	golang.org/x/text/internal/tag	0.020s</span><br><span class="line">?   	golang.org/x/text/internal/testtext	[no test files]</span><br><span class="line">ok  	golang.org/x/text/internal/ucd	0.020s</span><br><span class="line">ok  	golang.org/x/text/language	0.068s</span><br><span class="line">ok  	golang.org/x/text/unicode/cldr	0.063s</span><br><span class="line">ok  	rsc.io/quote	0.015s</span><br><span class="line">ok  	rsc.io/sampler	0.016s</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>在原版 go 命令中, 软件包模式 all 意味着 GOPATH 中能找到的所有软件包. 这几乎总是太多而无用. 在 vgo 中, 我们已经将 all 的含义缩小为 “当前模块中的所有软件包, 以及它们以递归方式导入的软件包”. rsc.io/quote 模块的 1.5.2 版本包含一个 buggy 包:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ vgo test rsc.io/quote/...</span><br><span class="line">ok  	rsc.io/quote	(cached)</span><br><span class="line">--- FAIL: Test (0.00s)</span><br><span class="line">	buggy_test.go:10: buggy!</span><br><span class="line">FAIL</span><br><span class="line">FAIL	rsc.io/quote/buggy	0.014s</span><br><span class="line">(exit status 1)</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>然而, 除非我们模块中的某个包导入 buggy, 否则它是不相干的, 所以它不包含在 all 里面. 无论如何, 升级的 x/text 看起来可以工作. 此时我们多半可以提交 go.mod.</p>
<p>另一种选择是使用 vgo get -u 升级构建所需的所有模块:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ vgo get -u</span><br><span class="line">vgo: finding golang.org/x/text latest</span><br><span class="line">vgo: finding rsc.io/quote latest</span><br><span class="line">vgo: finding rsc.io/sampler latest</span><br><span class="line">vgo: finding rsc.io/sampler v1.99.99</span><br><span class="line">vgo: finding golang.org/x/text latest</span><br><span class="line">vgo: downloading rsc.io/sampler v1.99.99</span><br><span class="line">$ cat go.mod</span><br><span class="line">module &quot;github.com/you/hello&quot;</span><br><span class="line"></span><br><span class="line">require (</span><br><span class="line">	&quot;golang.org/x/text&quot; v0.0.0-20180208041248-4e4a3210bb54</span><br><span class="line">	&quot;rsc.io/quote&quot; v1.5.2</span><br><span class="line">	&quot;rsc.io/sampler&quot; v1.99.99</span><br><span class="line">)</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>在这里, vgo get -u 保留了升级后的 text 模块, 并将 rsc.io/sampler 升级到其最新版本 v1.99.99.</p>
<p>让我们来运行测试:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ vgo test all</span><br><span class="line">?   	github.com/you/hello	[no test files]</span><br><span class="line">?   	golang.org/x/text/internal/gen	[no test files]</span><br><span class="line">ok  	golang.org/x/text/internal/tag	(cached)</span><br><span class="line">?   	golang.org/x/text/internal/testtext	[no test files]</span><br><span class="line">ok  	golang.org/x/text/internal/ucd	(cached)</span><br><span class="line">ok  	golang.org/x/text/language	0.070s</span><br><span class="line">ok  	golang.org/x/text/unicode/cldr	(cached)</span><br><span class="line">--- FAIL: TestHello (0.00s)</span><br><span class="line">	quote_test.go:19: Hello() = &quot;99 bottles of beer on the wall, 99 bottles of beer, ...&quot;, want &quot;Hello, world.&quot;</span><br><span class="line">FAIL</span><br><span class="line">FAIL	rsc.io/quote	0.014s</span><br><span class="line">--- FAIL: TestHello (0.00s)</span><br><span class="line">	hello_test.go:31: Hello([en-US fr]) = &quot;99 bottles of beer on the wall, 99 bottles of beer, ...&quot;, want &quot;Hello, world.&quot;</span><br><span class="line">	hello_test.go:31: Hello([fr en-US]) = &quot;99 bottles of beer on the wall, 99 bottles of beer, ...&quot;, want &quot;Bonjour le monde.&quot;</span><br><span class="line">FAIL</span><br><span class="line">FAIL	rsc.io/sampler	0.014s</span><br><span class="line">(exit status 1)</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>看起来 rsc.io/sampler v1.99.99 出了问题. 果然:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ vgo build</span><br><span class="line">$ ./hello</span><br><span class="line">99 bottles of beer on the wall, 99 bottles of beer, ...</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>vgo get -u 获取每个依赖的最新版本的行为正和 go get 下载所有不在 GOPATH 的包所做的一样. 在一个 GOPATH 里空无一物的系统上:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ go get -d rsc.io/hello</span><br><span class="line">$ go build -o badhello rsc.io/hello</span><br><span class="line">$ ./badhello</span><br><span class="line">99 bottles of beer on the wall, 99 bottles of beer, ...</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>重要的区别是, 默认情况下, vgo 不会以这种方式运行. 你也可以通过降级撤消它.</p>
<h3 id="降级"><a href="#降级" class="headerlink" title="降级"></a>降级</h3><p>要降级软件包, 请使用 vgo list -t 显示可用的标记(tag)版本:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ vgo list -t rsc.io/sampler</span><br><span class="line">rsc.io/sampler</span><br><span class="line">	v1.0.0</span><br><span class="line">	v1.2.0</span><br><span class="line">	v1.2.1</span><br><span class="line">	v1.3.0</span><br><span class="line">	v1.3.1</span><br><span class="line">	v1.99.99</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>然后使用 vgo 获取要求的特定版本, 例如 v1.3.1:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ cat go.mod</span><br><span class="line">module &quot;github.com/you/hello&quot;</span><br><span class="line"></span><br><span class="line">require (</span><br><span class="line">	&quot;golang.org/x/text&quot; v0.0.0-20180208041248-4e4a3210bb54</span><br><span class="line">	&quot;rsc.io/quote&quot; v1.5.2</span><br><span class="line">	&quot;rsc.io/sampler&quot; v1.99.99</span><br><span class="line">)</span><br><span class="line">$ vgo get rsc.io/sampler@v1.3.1</span><br><span class="line">vgo: finding rsc.io/sampler v1.3.1</span><br><span class="line">vgo: downloading rsc.io/sampler v1.3.1</span><br><span class="line">$ vgo list -m</span><br><span class="line">MODULE                VERSION</span><br><span class="line">github.com/you/hello  -</span><br><span class="line">golang.org/x/text     v0.0.0-20180208041248-4e4a3210bb54</span><br><span class="line">rsc.io/quote          v1.5.2</span><br><span class="line">rsc.io/sampler        v1.3.1</span><br><span class="line">$ cat go.mod</span><br><span class="line">module &quot;github.com/you/hello&quot;</span><br><span class="line"></span><br><span class="line">require (</span><br><span class="line">	&quot;golang.org/x/text&quot; v0.0.0-20180208041248-4e4a3210bb54</span><br><span class="line">	&quot;rsc.io/quote&quot; v1.5.2</span><br><span class="line">	&quot;rsc.io/sampler&quot; v1.3.1</span><br><span class="line">)</span><br><span class="line">$ vgo test all</span><br><span class="line">?   	github.com/you/hello	[no test files]</span><br><span class="line">?   	golang.org/x/text/internal/gen	[no test files]</span><br><span class="line">ok  	golang.org/x/text/internal/tag	(cached)</span><br><span class="line">?   	golang.org/x/text/internal/testtext	[no test files]</span><br><span class="line">ok  	golang.org/x/text/internal/ucd	(cached)</span><br><span class="line">ok  	golang.org/x/text/language	(cached)</span><br><span class="line">ok  	golang.org/x/text/unicode/cldr	(cached)</span><br><span class="line">ok  	rsc.io/quote	0.016s</span><br><span class="line">ok  	rsc.io/sampler	0.015s</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>降级一个软件包可能需要降级其他软件包. 例如:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ vgo get rsc.io/sampler@v1.2.0</span><br><span class="line">vgo: finding rsc.io/sampler v1.2.0</span><br><span class="line">vgo: finding rsc.io/quote v1.5.1</span><br><span class="line">vgo: finding rsc.io/quote v1.5.0</span><br><span class="line">vgo: finding rsc.io/quote v1.4.0</span><br><span class="line">vgo: finding rsc.io/sampler v1.0.0</span><br><span class="line">vgo: downloading rsc.io/sampler v1.2.0</span><br><span class="line">$ vgo list -m</span><br><span class="line">MODULE                VERSION</span><br><span class="line">github.com/you/hello  -</span><br><span class="line">golang.org/x/text     v0.0.0-20180208041248-4e4a3210bb54</span><br><span class="line">rsc.io/quote          v1.4.0</span><br><span class="line">rsc.io/sampler        v1.2.0</span><br><span class="line">$ cat go.mod</span><br><span class="line">module &quot;github.com/you/hello&quot;</span><br><span class="line"></span><br><span class="line">require (</span><br><span class="line">	&quot;golang.org/x/text&quot; v0.0.0-20180208041248-4e4a3210bb54</span><br><span class="line">	&quot;rsc.io/quote&quot; v1.4.0</span><br><span class="line">	&quot;rsc.io/sampler&quot; v1.2.0</span><br><span class="line">)</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>在这种情况下, rsc.io/quote v1.5.0 是第一个需要 rsc.io/sampler v1.3.0 的版本; 早期版本只需要 v1.0.0(或更高版本). 降级选择了 rsc.io/quote v1.4.0, 这是与 v1.2.0 兼容的最新版本.</p>
<p>也可以通过指定 none 作为版本来完全删除一个依赖, 这是一种极端的降级形式:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ vgo get rsc.io/sampler@none</span><br><span class="line">vgo: downloading rsc.io/quote v1.4.0</span><br><span class="line">vgo: finding rsc.io/quote v1.3.0</span><br><span class="line">$ vgo list -m</span><br><span class="line">MODULE                VERSION</span><br><span class="line">github.com/you/hello  -</span><br><span class="line">golang.org/x/text     v0.0.0-20180208041248-4e4a3210bb54</span><br><span class="line">rsc.io/quote          v1.3.0</span><br><span class="line">$ cat go.mod</span><br><span class="line">module &quot;github.com/you/hello&quot;</span><br><span class="line"></span><br><span class="line">require (</span><br><span class="line">	&quot;golang.org/x/text&quot; v0.0.0-20180208041248-4e4a3210bb54</span><br><span class="line">	&quot;rsc.io/quote&quot; v1.3.0</span><br><span class="line">)</span><br><span class="line">$ vgo test all</span><br><span class="line">vgo: downloading rsc.io/quote v1.3.0</span><br><span class="line">?   	github.com/you/hello	[no test files]</span><br><span class="line">ok  	rsc.io/quote	0.014s</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>让我们回到一切都是最新版本的状态, 包括 rsc.io/sampler v1.99.99:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ vgo get -u</span><br><span class="line">vgo: finding golang.org/x/text latest</span><br><span class="line">vgo: finding rsc.io/quote latest</span><br><span class="line">vgo: finding rsc.io/sampler latest</span><br><span class="line">vgo: finding golang.org/x/text latest</span><br><span class="line">$ vgo list -m</span><br><span class="line">MODULE                VERSION</span><br><span class="line">github.com/you/hello  -</span><br><span class="line">golang.org/x/text     v0.0.0-20180208041248-4e4a3210bb54</span><br><span class="line">rsc.io/quote          v1.5.2</span><br><span class="line">rsc.io/sampler        v1.99.99</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h3 id="排除-Excluding"><a href="#排除-Excluding" class="headerlink" title="排除 (Excluding)"></a>排除 (Excluding)</h3><p>在确定 v1.99.99 并不适用于我们的 hello world 程序后, 我们可能想记录下这个事实, 以避免将来出现问题. 我们可以通过向 go.mod 添加 exclude 指令来做到这一点:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">exclude &quot;rsc.io/sampler&quot; v1.99.99</span><br></pre></td></tr></table></figure>
<p>之后的操作表现的好像该模块不存在一样:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ echo &apos;exclude &quot;rsc.io/sampler&quot; v1.99.99&apos; &gt;&gt;go.mod</span><br><span class="line">$ vgo list -t rsc.io/sampler</span><br><span class="line">rsc.io/sampler</span><br><span class="line">	v1.0.0</span><br><span class="line">	v1.2.0</span><br><span class="line">	v1.2.1</span><br><span class="line">	v1.3.0</span><br><span class="line">	v1.3.1</span><br><span class="line">	v1.99.99 # excluded</span><br><span class="line">$ vgo get -u</span><br><span class="line">vgo: finding golang.org/x/text latest</span><br><span class="line">vgo: finding rsc.io/quote latest</span><br><span class="line">vgo: finding rsc.io/sampler latest</span><br><span class="line">vgo: finding rsc.io/sampler latest</span><br><span class="line">vgo: finding golang.org/x/text latest</span><br><span class="line">$ vgo list -m</span><br><span class="line">MODULE                VERSION</span><br><span class="line">github.com/you/hello  -</span><br><span class="line">golang.org/x/text     v0.0.0-20180208041248-4e4a3210bb54</span><br><span class="line">rsc.io/quote          v1.5.2</span><br><span class="line">rsc.io/sampler        v1.3.1</span><br><span class="line">$ cat go.mod</span><br><span class="line">module &quot;github.com/you/hello&quot;</span><br><span class="line"></span><br><span class="line">require (</span><br><span class="line">	&quot;golang.org/x/text&quot; v0.0.0-20180208041248-4e4a3210bb54</span><br><span class="line">	&quot;rsc.io/quote&quot; v1.5.2</span><br><span class="line">	&quot;rsc.io/sampler&quot; v1.3.1</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">exclude &quot;rsc.io/sampler&quot; v1.99.99</span><br><span class="line">$ vgo test all</span><br><span class="line">?   	github.com/you/hello	[no test files]</span><br><span class="line">?   	golang.org/x/text/internal/gen	[no test files]</span><br><span class="line">ok  	golang.org/x/text/internal/tag	(cached)</span><br><span class="line">?   	golang.org/x/text/internal/testtext	[no test files]</span><br><span class="line">ok  	golang.org/x/text/internal/ucd	(cached)</span><br><span class="line">ok  	golang.org/x/text/language	(cached)</span><br><span class="line">ok  	golang.org/x/text/unicode/cldr	(cached)</span><br><span class="line">ok  	rsc.io/quote	(cached)</span><br><span class="line">ok  	rsc.io/sampler	(cached)</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>排除仅适用于当前模块的构建. 如果当前模块被更大的构建所依赖, 则排除不适用. 例如, rsc.io/quote 的 go.mod 中的排除不适用于我们的 “hello, world” 构建.</p>
<p>这一策略的权衡让当前模块的作者几乎可以任意控制自己的构建, 而不会受到它们依赖的模块几乎任意控制的影响.</p>
<p>此时, 正确的下一步是联系 rsc.io/sampler 的作者并在 v1.99.99 中报告问题, 因此它可以在 v1.99.100 中修复. 不幸的是, 作者有一个博文依赖它而不予修复.</p>
<h3 id="替换-Replacing"><a href="#替换-Replacing" class="headerlink" title="替换 (Replacing)"></a>替换 (Replacing)</h3><p>如果确实在依赖中发现了问题, 则需要一种方法将其暂时替换为一个合适的副本. 假设我们想改变一些关于 rsc.io/quote 的行为. 也许我们想要解决 rsc.io/sampler 中的问题, 或者我们想要做其他的事情. 第一步是使用通常的 git 命令检出 quote 模块:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ git clone https://github.com/rsc/quote ../quote</span><br><span class="line">Cloning into &apos;../quote&apos;...</span><br></pre></td></tr></table></figure>
<p>然后编辑 ../quote/quote.go 来改变 func Hello 的一些内容. 例如, 我把它的返回值从 sampler.Hello() 更改为 sampler.Glass(), 这是一个更有趣的问候语.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ cd ../quote</span><br><span class="line">$ &lt;edit quote.go&gt;</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>改变了克隆代码之后, 我们可以通过向 go.mod 添加 replace 指令来让我们的构建使用它来代替真正的构建:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">replace &quot;rsc.io/quote&quot; v1.5.2 =&gt; &quot;../quote&quot;</span><br></pre></td></tr></table></figure>
<p>然后我们可以使用它来构建我们的程序:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ cd ../hello</span><br><span class="line">$ echo &apos;replace &quot;rsc.io/quote&quot; v1.5.2 =&gt; &quot;../quote&quot;&apos; &gt;&gt;go.mod</span><br><span class="line">$ vgo list -m</span><br><span class="line">MODULE                VERSION</span><br><span class="line">github.com/you/hello  -</span><br><span class="line">golang.org/x/text     v0.0.0-20180208041248-4e4a3210bb54</span><br><span class="line">rsc.io/quote          v1.5.2</span><br><span class="line"> =&gt; ../quote</span><br><span class="line">rsc.io/sampler        v1.3.1</span><br><span class="line">$ vgo build</span><br><span class="line">$ ./hello</span><br><span class="line">I can eat glass and it doesn&apos;t hurt me.</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>你也可以将一个不同的模块命名为替换模块. 例如, 你可以克隆 github.com/rsc/quote, 然后将更改推送到你自己的分支.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ cd ../quote</span><br><span class="line">$ git commit -a -m &apos;my fork&apos;</span><br><span class="line">[master 6151719] my fork</span><br><span class="line"> 1 file changed, 1 insertion(+), 1 deletion(-)</span><br><span class="line">$ git tag v0.0.0-myfork</span><br><span class="line">$ git pu https://github.com/you/quote v0.0.0-myfork</span><br><span class="line">To https://github.com/you/quote</span><br><span class="line"> * [new tag]         v0.0.0-myfork -&gt; v0.0.0-myfork</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>然后你可以使用它作为替换:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ cd ../hello</span><br><span class="line">$ echo &apos;replace &quot;rsc.io/quote&quot; v1.5.2 =&gt; &quot;github.com/you/quote&quot; v0.0.0-myfork&apos; &gt;&gt;go.mod</span><br><span class="line">$ vgo list -m</span><br><span class="line">vgo: finding github.com/you/quote v0.0.0-myfork</span><br><span class="line">MODULE                    VERSION</span><br><span class="line">github.com/you/hello      -</span><br><span class="line">golang.org/x/text         v0.0.0-20180208041248-4e4a3210bb54</span><br><span class="line">rsc.io/quote              v1.5.2</span><br><span class="line"> =&gt; github.com/you/quote  v0.0.0-myfork</span><br><span class="line">rsc.io/sampler            v1.3.1</span><br><span class="line">$ vgo build</span><br><span class="line">vgo: downloading github.com/you/quote v0.0.0-myfork</span><br><span class="line">$ LANG=fr ./hello</span><br><span class="line">Je peux manger du verre, ça ne me fait pas mal.</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h3 id="向后兼容性"><a href="#向后兼容性" class="headerlink" title="向后兼容性"></a>向后兼容性</h3><p>即使你想为你的项目使用 vgo, 你也不可能要求你的所有的用户都有 vgo. 相反, 你可以创建一个 vendor 目录, 以允许 go 命令用户生成几乎相同的构建(当然, 在 GOPATH 中编译):</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ vgo vendor</span><br><span class="line">$ mkdir -p $GOPATH/src/github.com/you</span><br><span class="line">$ cp -a . $GOPATH/src/github.com/you/hello</span><br><span class="line">$ go build -o vhello github.com/you/hello</span><br><span class="line">$ LANG=es ./vhello</span><br><span class="line">Puedo comer vidrio, no me hace daño.</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>我说这些构建 “几乎相同”, 因为工具链看到的并在最终二进制文件中记录的导入路径是不同的. vendored 版本参见 vendor 目录:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ go tool nm hello | grep sampler.hello</span><br><span class="line"> 1170908 B rsc.io/sampler.hello</span><br><span class="line">$ go tool nm vhello | grep sampler.hello</span><br><span class="line"> 11718e8 B github.com/you/hello/vendor/rsc.io/sampler.hello</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>除了这种差异, 构建应该产生相同的二进制文件. 为了提供优雅的转换, 基于 vgo 的构建完全忽略 vendor 目录, 一如既往的模块感知 go 命令构建.</p>
<h2 id="接下来"><a href="#接下来" class="headerlink" title="接下来 ?"></a>接下来 ?</h2><p>请尝试 vgo. 在存储库中开始标记(tagging)版本. 创建并检入(check in) go.mod 文件. 在 golang.org/issue 上上报问题, 并在标题开头添加 “x/vgo:” 明天会有更多的博文. 谢谢, 玩得开心!</p>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Archives</a></li>
         
          <li><a href="/atom.xml">Feed</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#示例"><span class="toc-number">1.</span> <span class="toc-text">示例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Hello-world"><span class="toc-number">1.1.</span> <span class="toc-text">Hello, world</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#升级"><span class="toc-number">1.2.</span> <span class="toc-text">升级</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#降级"><span class="toc-number">1.3.</span> <span class="toc-text">降级</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#排除-Excluding"><span class="toc-number">1.4.</span> <span class="toc-text">排除 (Excluding)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#替换-Replacing"><span class="toc-number">1.5.</span> <span class="toc-text">替换 (Replacing)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#向后兼容性"><span class="toc-number">1.6.</span> <span class="toc-text">向后兼容性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#接下来"><span class="toc-number">2.</span> <span class="toc-text">接下来 ?</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://lingchao.xin/post/vgo-tour.html"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://lingchao.xin/post/vgo-tour.html&text=版本化 Go 之旅"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://lingchao.xin/post/vgo-tour.html&title=版本化 Go 之旅"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://lingchao.xin/post/vgo-tour.html&is_video=false&description=版本化 Go 之旅"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=版本化 Go 之旅&body=Check out this article: https://lingchao.xin/post/vgo-tour.html"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://lingchao.xin/post/vgo-tour.html&title=版本化 Go 之旅"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://lingchao.xin/post/vgo-tour.html&title=版本化 Go 之旅"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://lingchao.xin/post/vgo-tour.html&title=版本化 Go 之旅"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://lingchao.xin/post/vgo-tour.html&title=版本化 Go 之旅"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://lingchao.xin/post/vgo-tour.html&name=版本化 Go 之旅&description=&lt;p&gt;本文译自 &lt;a href=&#34;https://research.swtch.com/vgo-tour&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;A Tour of Versioned Go (vgo)&lt;/a&gt;, &lt;a href=&#34;https://lingchao.xin/tag/vgo.html&#34;&gt;Go &amp;amp; Versioning&lt;/a&gt; 的第 2 部分, 版权@归原文所有.&lt;br&gt;"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2018 Lingchao Xin
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Archives</a></li>
         
          <li><a href="/atom.xml">Feed</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/fontawesome-all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-47053188-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'douglarek';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


